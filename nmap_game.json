[
  {
    "command": "nmap -sV 192.168.56.11",
    "matches": [
      "I want to detect service versions running on open ports",
      "I want to identify which software and versions are exposed"
    ],
    "flags_and_protocol": "-sV enables service and version detection. After discovering open ports, Nmap sends protocol-specific probes and analyzes responses to determine the service type and version.",
    "red_team": "Useful for identifying exact software versions to map against known vulnerabilities (e.g., outdated Apache, OpenSSH). Often combined with -sC or -A for deeper enumeration.",
    "blue_team": "Generates unusual or malformed service requests visible in application logs. IDS/IPS may detect version probing signatures. Repeated banner-grabbing behavior can indicate reconnaissance.",
    "combo": [
      "-sC for default script scan",
      "-A for OS + version + script + traceroute",
      "-p- to scan all TCP ports",
      "-T4 to increase scan speed"
    ]
  },
  {
    "command": "nmap -O 192.168.56.12",
    "matches": [
      "I want to detect the operating system of a target",
      "I want to fingerprint the OS remotely"
    ],
    "flags_and_protocol": "-O enables OS detection. Nmap sends specially crafted TCP/IP probes and compares responses against its fingerprint database.",
    "red_team": "Helps tailor exploits and payloads to the correct OS. Reduces guesswork when planning privilege escalation or lateral movement.",
    "blue_team": "Detected as abnormal TCP packets with unusual flag combinations. IDS tools can flag OS fingerprinting attempts based on known probe patterns.",
    "combo": [
      "-sV for service + OS detection",
      "--osscan-guess for more aggressive OS guessing",
      "-A for full aggressive scan",
      "-Pn if host discovery is blocked"
    ]
  },
  {
    "command": "nmap -Pn 192.168.56.13",
    "matches": [
      "I want to skip host discovery",
      "I want to scan a host that blocks ICMP"
    ],
    "flags_and_protocol": "-Pn disables host discovery and assumes the host is up. Nmap skips ICMP echo, TCP ACK, and other discovery probes and directly performs port scanning.",
    "red_team": "Useful when firewalls block ping (ICMP). Prevents false negatives where a host appears down but actually isn\u2019t.",
    "blue_team": "Port scan activity begins without prior ICMP traffic. Monitoring systems may detect direct scanning behavior without standard discovery patterns.",
    "combo": [
      "-sS for SYN scan without host discovery",
      "-sV for version detection on assumed-up host",
      "-p- for full port scan",
      "-T4 for faster execution"
    ]
  },
  {
    "command": "nmap -sU 192.168.56.14",
    "matches": [
      "I want to scan UDP ports",
      "I want to discover open UDP services like DNS or SNMP"
    ],
    "flags_and_protocol": "-sU performs a UDP scan. Nmap sends UDP packets to target ports and interprets ICMP 'port unreachable' responses or lack of response to determine port state.",
    "red_team": "Important for discovering services like DNS (53), SNMP (161), or NTP (123) that are often overlooked. Slower and noisier than TCP scans.",
    "blue_team": "Visible as UDP probes to multiple ports. Firewalls log repeated UDP attempts and ICMP unreachable replies. High UDP sweep activity may trigger alerts.",
    "combo": [
      "-sS to scan TCP + UDP together",
      "-p 53,161,123 to target common UDP services",
      "-sV for UDP service version detection",
      "--top-ports 100 for faster UDP discovery"
    ]
  },
  {
    "command": "nmap -D RND:5 192.168.56.15",
    "matches": [
      "I want to use decoy IP addresses",
      "I want to obscure the real source of my scan"
    ],
    "flags_and_protocol": "-D specifies decoy IP addresses. RND:5 generates 5 random decoys. The target sees scan traffic appearing to originate from multiple IPs.",
    "red_team": "Adds noise to make attribution harder. Can confuse simple logging systems that do not correlate traffic patterns deeply.",
    "blue_team": "Multiple apparent sources scanning simultaneously is suspicious. Advanced monitoring can correlate timing patterns to identify the true scanning host.",
    "combo": [
      "-sS for stealth SYN scan with decoys",
      "-Pn to skip host discovery while using decoys",
      "-p- to perform a full port sweep",
      "-T4 to increase scan aggressiveness"
    ]
  },
  {
    "command": "nmap -p- -T4 192.168.56.16",
    "matches": [
      "I want to scan all ports quickly",
      "I want to increase scan speed"
    ],
    "flags_and_protocol": "-p- scans all 65535 TCP ports. -T4 increases timing aggressiveness, reducing delays between probes and speeding up the scan.",
    "red_team": "Useful during lab or internal assessments when speed matters. Higher timing can increase detection risk.",
    "blue_team": "Large volume of connection attempts across all ports in a short time window. Easily detectable by rate-based monitoring and port sweep alerts.",
    "combo": [
      "-sV to detect service versions on all ports",
      "-O for OS fingerprinting",
      "-Pn to skip host discovery",
      "-A for comprehensive aggressive scan"
    ]
  },
  {
    "command": "nmap -sn TARGETS",
    "matches": [
      "I only want host discovery without a port scan",
      "I want to quickly find which targets are up"
    ],
    "flags_and_protocol": "-sn performs host discovery only (ping scan) and skips port scanning. Nmap uses its default host discovery probes (ARP on local subnet, plus ICMP/TCP probes depending on privileges and network context).",
    "red_team": "Fast way to build an initial live-host list before deeper enumeration. Useful for reducing scan noise and focusing later scans on online systems.",
    "blue_team": "Appears as broad discovery traffic with limited follow-up ports. Defenders can detect sweeps that enumerate many hosts in a short period.",
    "combo": [
      "-PR -sn for explicit ARP discovery on local subnet",
      "-PE -sn for ICMP echo discovery",
      "-PP -sn for ICMP timestamp discovery",
      "-PM -sn for ICMP address mask discovery"
    ]
  },
  {
    "command": "nmap -PR -sn MACHINE_IP/24",
    "matches": [
      "I want to discover live hosts on my local subnet using ARP",
      "I need reliable host discovery on a LAN where ICMP may be filtered"
    ],
    "flags_and_protocol": "-PR tells Nmap to use ARP requests for host discovery; -sn skips port scanning. ARP is link-layer and typically very reliable for local-network live-host detection. This focuses on Nmap ARP discovery (not the separate arp-scan tool, which can provide similar ARP-based sweeps).",
    "red_team": "Excellent first step on an internal segment: ARP replies identify live neighbors even when host firewalls block ICMP echo. Great for quickly mapping a /24.",
    "blue_team": "Produces bursts of ARP who-has requests across the subnet. Network monitoring can flag unusual ARP sweep behavior as reconnaissance.",
    "combo": [
      "-sn to keep discovery-only behavior",
      "-PE -sn to compare ICMP echo results",
      "-PP -sn to test timestamp responses",
      "-PM -sn to test address mask responses"
    ]
  },
  {
    "command": "nmap -PE -sn MACHINE_IP/24",
    "matches": [
      "I want to discover live hosts using ICMP echo requests",
      "I want a ping sweep with Nmap"
    ],
    "flags_and_protocol": "-PE uses ICMP Echo Request (Type 8) for host discovery and expects Echo Reply (Type 0). -sn ensures Nmap does not continue with a port scan.",
    "red_team": "Useful for broad ping sweeps, but results can miss hosts behind firewalls that drop ICMP echo.",
    "blue_team": "Visible as ICMP echo sweep traffic. Many security tools detect sequential ping activity across subnets.",
    "combo": [
      "-sn for host discovery only",
      "-PR -sn for local-subnet ARP discovery",
      "-PP -sn for ICMP timestamp probes",
      "-PM -sn for ICMP address mask probes"
    ]
  },
  {
    "command": "nmap -PP -sn MACHINE_IP/24",
    "matches": [
      "I want to discover live hosts with ICMP timestamp requests",
      "ICMP echo is blocked and I want another ICMP host-discovery method"
    ],
    "flags_and_protocol": "-PP sends ICMP Timestamp Request (Type 13) and looks for Timestamp Reply (Type 14). With -sn, Nmap performs host discovery without port scanning.",
    "red_team": "Alternative discovery method when echo responses are filtered but timestamp replies are still permitted.",
    "blue_team": "Can look suspicious because timestamp probes are less common in normal traffic. Detection rules often treat this as reconnaissance.",
    "combo": [
      "-sn to avoid port scan phase",
      "-PE -sn for ICMP echo discovery",
      "-PM -sn for ICMP address mask discovery",
      "-PR -sn for LAN ARP discovery"
    ]
  },
  {
    "command": "nmap -PM -sn MACHINE_IP/24",
    "matches": [
      "I want to discover live hosts with ICMP address mask requests",
      "I want another ICMP-based host discovery option"
    ],
    "flags_and_protocol": "-PM sends ICMP Address Mask Request (Type 17) and waits for Address Mask Reply (Type 18). -sn keeps the scan in host-discovery mode only.",
    "red_team": "Niche but useful when testing multiple discovery paths to avoid false negatives from filtered ICMP echo.",
    "blue_team": "Address mask probes are uncommon and often stand out in telemetry, making them useful for early reconnaissance detection.",
    "combo": [
      "-sn for no port scan",
      "-PE -sn for echo-request discovery",
      "-PP -sn for timestamp discovery",
      "-PR -sn for reliable local ARP host discovery"
    ]
  }
]
